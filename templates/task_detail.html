{% extends "base.html" %}

{% block title %}{{ task.title }} - HighCommand{% endblock %}

{% block content %}
<div style="margin-bottom: 16px;">
    <a href="{{ url_for('project_detail', project_id=project.id) }}" class="btn btn-small">← BACK TO PROJECT</a>
</div>

<div class="page-header">
    <h1 class="page-title">{{ task.title }}</h1>
    <div class="page-actions">
        {% if can_edit and task.status != 'done' %}
        <form method="POST" action="{{ url_for('task_mark_complete', task_id=task.id) }}" style="display: inline;">
            <button type="submit" class="btn btn-success">✓ COMPLETED</button>
        </form>
        {% endif %}
        {% if can_edit %}
        <a href="{{ url_for('task_edit', task_id=task.id) }}" class="btn">EDIT</a>
        {% endif %}
    </div>
</div>

<div class="card mb-3">
    <div class="detail-row">
        <div class="detail-label">PROJECT</div>
        <div class="detail-value">
            <a href="{{ url_for('project_detail', project_id=project.id) }}">{{ project.name }}</a>
        </div>
    </div>
    <div class="detail-row">
        <div class="detail-label">STATUS</div>
        <div class="detail-value">
            <span class="badge badge-{{ task.status }}">{{ task.status|upper }}</span>
        </div>
    </div>
    <div class="detail-row">
        <div class="detail-label">PRIORITY</div>
        <div class="detail-value">
            <span class="badge badge-{{ task.priority }}">{{ task.priority|upper }}</span>
        </div>
    </div>
    <div class="detail-row">
        <div class="detail-label">ASSIGNEES</div>
        <div class="detail-value">{{ task.assignee_names }}</div>
    </div>
    <div class="detail-row">
        <div class="detail-label">DUE DATE</div>
        <div class="detail-value">{{ task.due_date or 'Not set' }}</div>
    </div>
    <div class="detail-row">
        <div class="detail-label">CREATOR</div>
        <div class="detail-value">{{ task.creator_name }}</div>
    </div>
    <div class="detail-row" style="border-bottom: none;">
        <div class="detail-label">CREATED</div>
        <div class="detail-value">{{ task.created_at }}</div>
    </div>
</div>

<div class="section">
    <div class="section-header">DESCRIPTION</div>
    <div class="card">
        {{ task.description or 'No description provided.' }}
    </div>
</div>

{% if can_edit %}
<div class="detail-actions">
    <form method="POST" action="{{ url_for('task_delete', task_id=task.id) }}"
        onsubmit="return confirm('DELETE THIS TASK? THIS CANNOT BE UNDONE.');">
        <button type="submit" class="btn btn-danger">DELETE TASK</button>
    </form>
</div>
{% endif %}
{% endblock %}